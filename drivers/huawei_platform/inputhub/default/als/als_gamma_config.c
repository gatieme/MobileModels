/*
 * Copyright (c) Huawei Technologies Co., Ltd. 2020-2020. All rights reserved.
 * Description: als gamma config source file
 * Author: linjianpeng <linjianpeng1@huawei.com>
 * Create: 2020-05-25
 */

#include "als_gamma_config.h"

#include <linux/err.h>
#include <linux/of.h>
#include <linux/of_device.h>
#include <linux/of_gpio.h>
#include <linux/slab.h>
#include <linux/types.h>

#include <securec.h>

#include "als_sysfs.h"
#include "contexthub_boot.h"
#include "contexthub_recovery.h"
#include "contexthub_route.h"
#include "als_tp_color.h"
#ifdef DSS_ALSC_NOISE
#include "display_effect_alsc_interface.h"
#endif
#ifdef DKMD_ALSC_NOISE
#include "dkmd_alsc_interface.h"
#endif

#define ALS_ALPHA_VAL_MAX 4095
#define ALS_ALPHA_HALF_MAX 2047
#define ALS_ALPHA_RANGE_PER_STEP 16

#define DEGAMMA_COEF_LEN 257
#define COEF_MIPI_HXX_CXX 4
#define EDITION_SENSORFLAG_SHIFT 20240122

static uint16_t g_product_type;
static uint16_t g_sensor_type;
static uint16_t g_lcd_type;

enum sensor_als_gamma_type{
	GAMMA_TYPE_DEFAULT,
	GAMMA_TYPE_O_BOE = 0x31,
	GAMMA_TYPE_N_BOE = 0x41,
	GAMMA_TYPE_N_SM = 0x42,
	GAMMA_TYPE_N_LG = 0x43,
	GAMMA_TYPE_NP_BOE = 0x51,
	GAMMA_TYPE_NP_SM = 0x52,
	GAMMA_TYPE_NP_LG = 0x53,
	GAMMA_TYPE_J_BOE = 0xB1,
	GAMMA_TYPE_J_LG = 0xB3,
};

typedef enum {
	PRODUCT_OTHER,
	PRODUCT_EBG,
	PRODUCT_JER,
	PRODUCT_OCEAN,
	PRODUCT_NOAH,
	PRODUCT_NOAHP,
	PRODUCT_TENTON,
	PRODUCT_ANGELA,
	PRODUCT_YORK,
	PRODUCT_BARBIE,
	PRODUCT_AMBER,
	PRODUCT_JAD,
	PRODUCT_RNA,
	PRODUCT_NTH,
	PRODUCT_BALI,
	PRODUCT_PAL, // 15
	PRODUCT_CET,
	PRODUCT_ABL,
	PRODUCT_GLORIA,
	PRODUCT_NICOLE,
	PRODUCT_JADEQ, // 20
	PRODUCT_CEL,
	PRODUCT_BALINEW,
	PRODUCT_ALT_A,
	PRODUCT_MNA,
	PRODUCT_LNA, // 25
	PRODUCT_JANET,
	PRODUCT_FIONA,
	PRODUCT_ALLEN,
	PRODUCT_BARRY,
	PRODUCT_ALT_B, // 30
	PRODUCT_LEM,
	PRODUCT_LINA,
	PRODUCT_ADELA,
	PRODUCT_BLAKE,
	PRODUCT_GRL,
	PRODUCT_ADY,
	PRODUCT_HBN,
	PRODUCT_ADL,
	PRODUCT_PSD,
	PRODUCT_CLS,
	PRODUCT_PLR,
	PRODUCT_PLA,
	PRODUCT_BLS = 45,
	PRODUCT_MIS = 47,
} product_type_t;

struct als_gamma_config {
	uint8_t is_init;
	uint8_t alpha_is_set;
	uint32_t alpha_val;
	uint32_t alpha_gamma;
	u32 *r_gamma;
	u32 *g_gamma;
	u32 *b_gamma;
};

#if ((defined DSS_ALSC_NOISE) || (defined DKMD_ALSC_NOISE))
static struct als_gamma_config g_als_gamma_cfg;

static u32 g_gamma_1_2[DEGAMMA_COEF_LEN] = {
	0x0000, 0x0005, 0x000c, 0x0014, 0x001c, 0x0025, 0x002e, 0x0037,
	0x0040, 0x004a, 0x0054, 0x005e, 0x0069, 0x0073, 0x007e, 0x0089,
	0x0094, 0x009f, 0x00aa, 0x00b6, 0x00c1, 0x00cd, 0x00d8, 0x00e4,
	0x00f0, 0x00fc, 0x0108, 0x0115, 0x0121, 0x012d, 0x013a, 0x0147,
	0x0153, 0x0160, 0x016d, 0x017a, 0x0187, 0x0194, 0x01a1, 0x01ae,
	0x01bb, 0x01c9, 0x01d6, 0x01e4, 0x01f1, 0x01ff, 0x020c, 0x021a,
	0x0228, 0x0236, 0x0244, 0x0252, 0x0260, 0x026e, 0x027c, 0x028a,
	0x0298, 0x02a6, 0x02b5, 0x02c3, 0x02d1, 0x02e0, 0x02ee, 0x02fd,
	0x030c, 0x031a, 0x0329, 0x0338, 0x0346, 0x0355, 0x0364, 0x0373,
	0x0382, 0x0391, 0x03a0, 0x03af, 0x03be, 0x03cd, 0x03dc, 0x03ec,
	0x03fb, 0x040a, 0x0419, 0x0429, 0x0438, 0x0448, 0x0457, 0x0467,
	0x0476, 0x0486, 0x0496, 0x04a5, 0x04b5, 0x04c5, 0x04d4, 0x04e4,
	0x04f4, 0x0504, 0x0514, 0x0524, 0x0534, 0x0544, 0x0554, 0x0564,
	0x0574, 0x0584, 0x0594, 0x05a4, 0x05b5, 0x05c5, 0x05d5, 0x05e5,
	0x05f6, 0x0606, 0x0616, 0x0627, 0x0637, 0x0648, 0x0658, 0x0669,
	0x0679, 0x068a, 0x069b, 0x06ab, 0x06bc, 0x06cd, 0x06dd, 0x06ee,
	0x06ff, 0x0710, 0x0720, 0x0731, 0x0742, 0x0753, 0x0764, 0x0775,
	0x0786, 0x0797, 0x07a8, 0x07b9, 0x07ca, 0x07db, 0x07ec, 0x07fe,
	0x080f, 0x0820, 0x0831, 0x0842, 0x0854, 0x0865, 0x0876, 0x0888,
	0x0899, 0x08aa, 0x08bc, 0x08cd, 0x08df, 0x08f0, 0x0902, 0x0913,
	0x0925, 0x0936, 0x0948, 0x0959, 0x096b, 0x097d, 0x098e, 0x09a0,
	0x09b2, 0x09c4, 0x09d5, 0x09e7, 0x09f9, 0x0a0b, 0x0a1d, 0x0a2e,
	0x0a40, 0x0a52, 0x0a64, 0x0a76, 0x0a88, 0x0a9a, 0x0aac, 0x0abe,
	0x0ad0, 0x0ae2, 0x0af4, 0x0b06, 0x0b19, 0x0b2b, 0x0b3d, 0x0b4f,
	0x0b61, 0x0b73, 0x0b86, 0x0b98, 0x0baa, 0x0bbc, 0x0bcf, 0x0be1,
	0x0bf3, 0x0c06, 0x0c18, 0x0c2b, 0x0c3d, 0x0c4f, 0x0c62, 0x0c74,
	0x0c87, 0x0c99, 0x0cac, 0x0cbe, 0x0cd1, 0x0ce4, 0x0cf6, 0x0d09,
	0x0d1b, 0x0d2e, 0x0d41, 0x0d53, 0x0d66, 0x0d79, 0x0d8c, 0x0d9e,
	0x0db1, 0x0dc4, 0x0dd7, 0x0dea, 0x0dfc, 0x0e0f, 0x0e22, 0x0e35,
	0x0e48, 0x0e5b, 0x0e6e, 0x0e81, 0x0e94, 0x0ea7, 0x0eba, 0x0ecd,
	0x0ee0, 0x0ef3, 0x0f06, 0x0f19, 0x0f2c, 0x0f3f, 0x0f52, 0x0f65,
	0x0f78, 0x0f8c, 0x0f9f, 0x0fb2, 0x0fc5, 0x0fd8, 0x0fec, 0x0fff,
	0x0fff
};

static u32 g_gamma_1_3[DEGAMMA_COEF_LEN] = {
	0x0000, 0x0003, 0x0008, 0x000d, 0x0012, 0x0019, 0x001f, 0x0026,
	0x002d, 0x0035, 0x003d, 0x0045, 0x004d, 0x0055, 0x005e, 0x0067,
	0x0070, 0x0079, 0x0082, 0x008c, 0x0096, 0x009f, 0x00a9, 0x00b3,
	0x00be, 0x00c8, 0x00d2, 0x00dd, 0x00e8, 0x00f3, 0x00fe, 0x0109,
	0x0114, 0x011f, 0x012a, 0x0136, 0x0141, 0x014d, 0x0159, 0x0165,
	0x0170, 0x017d, 0x0189, 0x0195, 0x01a1, 0x01ad, 0x01ba, 0x01c6,
	0x01d3, 0x01e0, 0x01ed, 0x01f9, 0x0206, 0x0213, 0x0220, 0x022d,
	0x023b, 0x0248, 0x0255, 0x0263, 0x0270, 0x027e, 0x028b, 0x0299,
	0x02a7, 0x02b5, 0x02c3, 0x02d1, 0x02df, 0x02ed, 0x02fb, 0x0309,
	0x0317, 0x0326, 0x0334, 0x0342, 0x0351, 0x035f, 0x036e, 0x037d,
	0x038b, 0x039a, 0x03a9, 0x03b8, 0x03c7, 0x03d6, 0x03e5, 0x03f4,
	0x0403, 0x0412, 0x0421, 0x0431, 0x0440, 0x0450, 0x045f, 0x046e,
	0x047e, 0x048e, 0x049d, 0x04ad, 0x04bd, 0x04cc, 0x04dc, 0x04ec,
	0x04fc, 0x050c, 0x051c, 0x052c, 0x053c, 0x054c, 0x055d, 0x056d,
	0x057d, 0x058e, 0x059e, 0x05ae, 0x05bf, 0x05cf, 0x05e0, 0x05f0,
	0x0601, 0x0612, 0x0622, 0x0633, 0x0644, 0x0655, 0x0666, 0x0677,
	0x0688, 0x0699, 0x06aa, 0x06bb, 0x06cc, 0x06dd, 0x06ee, 0x06ff,
	0x0711, 0x0722, 0x0733, 0x0745, 0x0756, 0x0768, 0x0779, 0x078b,
	0x079c, 0x07ae, 0x07bf, 0x07d1, 0x07e3, 0x07f5, 0x0806, 0x0818,
	0x082a, 0x083c, 0x084e, 0x0860, 0x0872, 0x0884, 0x0896, 0x08a8,
	0x08ba, 0x08cc, 0x08de, 0x08f1, 0x0903, 0x0915, 0x0928, 0x093a,
	0x094c, 0x095f, 0x0971, 0x0984, 0x0996, 0x09a9, 0x09bc, 0x09ce,
	0x09e1, 0x09f4, 0x0a06, 0x0a19, 0x0a2c, 0x0a3f, 0x0a51, 0x0a64,
	0x0a77, 0x0a8a, 0x0a9d, 0x0ab0, 0x0ac3, 0x0ad6, 0x0ae9, 0x0afd,
	0x0b10, 0x0b23, 0x0b36, 0x0b49, 0x0b5d, 0x0b70, 0x0b83, 0x0b97,
	0x0baa, 0x0bbd, 0x0bd1, 0x0be4, 0x0bf8, 0x0c0b, 0x0c1f, 0x0c33,
	0x0c46, 0x0c5a, 0x0c6e, 0x0c81, 0x0c95, 0x0ca9, 0x0cbd, 0x0cd0,
	0x0ce4, 0x0cf8, 0x0d0c, 0x0d20, 0x0d34, 0x0d48, 0x0d5c, 0x0d70,
	0x0d84, 0x0d98, 0x0dac, 0x0dc0, 0x0dd5, 0x0de9, 0x0dfd, 0x0e11,
	0x0e25, 0x0e3a, 0x0e4e, 0x0e62, 0x0e77, 0x0e8b, 0x0ea0, 0x0eb4,
	0x0ec9, 0x0edd, 0x0ef2, 0x0f06, 0x0f1b, 0x0f2f, 0x0f44, 0x0f59,
	0x0f6d, 0x0f82, 0x0f97, 0x0fac, 0x0fc0, 0x0fd5, 0x0fea, 0x0fff,
	0x0fff
};

static u32 g_gamma_1_4[DEGAMMA_COEF_LEN] = {
	0x0000, 0x0002, 0x0005, 0x0008, 0x000c, 0x0011, 0x0016, 0x001b,
	0x0020, 0x0026, 0x002c, 0x0032, 0x0039, 0x003f, 0x0046, 0x004e,
	0x0055, 0x005c, 0x0064, 0x006c, 0x0074, 0x007c, 0x0085, 0x008d,
	0x0096, 0x009f, 0x00a8, 0x00b1, 0x00ba, 0x00c3, 0x00cd, 0x00d6,
	0x00e0, 0x00ea, 0x00f4, 0x00fe, 0x0108, 0x0113, 0x011d, 0x0128,
	0x0132, 0x013d, 0x0148, 0x0153, 0x015e, 0x0169, 0x0174, 0x0180,
	0x018b, 0x0197, 0x01a2, 0x01ae, 0x01ba, 0x01c6, 0x01d2, 0x01de,
	0x01ea, 0x01f7, 0x0203, 0x0210, 0x021c, 0x0229, 0x0236, 0x0242,
	0x024f, 0x025c, 0x0269, 0x0276, 0x0284, 0x0291, 0x029e, 0x02ac,
	0x02b9, 0x02c7, 0x02d4, 0x02e2, 0x02f0, 0x02fe, 0x030c, 0x031a,
	0x0328, 0x0336, 0x0344, 0x0353, 0x0361, 0x0370, 0x037e, 0x038d,
	0x039b, 0x03aa, 0x03b9, 0x03c8, 0x03d7, 0x03e6, 0x03f5, 0x0404,
	0x0413, 0x0422, 0x0432, 0x0441, 0x0450, 0x0460, 0x046f, 0x047f,
	0x048f, 0x049e, 0x04ae, 0x04be, 0x04ce, 0x04de, 0x04ee, 0x04fe,
	0x050e, 0x051e, 0x052f, 0x053f, 0x054f, 0x0560, 0x0570, 0x0581,
	0x0591, 0x05a2, 0x05b3, 0x05c4, 0x05d4, 0x05e5, 0x05f6, 0x0607,
	0x0618, 0x0629, 0x063a, 0x064c, 0x065d, 0x066e, 0x0680, 0x0691,
	0x06a2, 0x06b4, 0x06c6, 0x06d7, 0x06e9, 0x06fb, 0x070c, 0x071e,
	0x0730, 0x0742, 0x0754, 0x0766, 0x0778, 0x078a, 0x079c, 0x07ae,
	0x07c1, 0x07d3, 0x07e5, 0x07f8, 0x080a, 0x081d, 0x082f, 0x0842,
	0x0854, 0x0867, 0x087a, 0x088d, 0x089f, 0x08b2, 0x08c5, 0x08d8,
	0x08eb, 0x08fe, 0x0911, 0x0924, 0x0938, 0x094b, 0x095e, 0x0971,
	0x0985, 0x0998, 0x09ac, 0x09bf, 0x09d3, 0x09e6, 0x09fa, 0x0a0e,
	0x0a21, 0x0a35, 0x0a49, 0x0a5d, 0x0a71, 0x0a84, 0x0a98, 0x0aac,
	0x0ac0, 0x0ad5, 0x0ae9, 0x0afd, 0x0b11, 0x0b25, 0x0b3a, 0x0b4e,
	0x0b62, 0x0b77, 0x0b8b, 0x0ba0, 0x0bb4, 0x0bc9, 0x0bdd, 0x0bf2,
	0x0c07, 0x0c1c, 0x0c30, 0x0c45, 0x0c5a, 0x0c6f, 0x0c84, 0x0c99,
	0x0cae, 0x0cc3, 0x0cd8, 0x0ced, 0x0d02, 0x0d18, 0x0d2d, 0x0d42,
	0x0d57, 0x0d6d, 0x0d82, 0x0d98, 0x0dad, 0x0dc3, 0x0dd8, 0x0dee,
	0x0e03, 0x0e19, 0x0e2f, 0x0e45, 0x0e5a, 0x0e70, 0x0e86, 0x0e9c,
	0x0eb2, 0x0ec8, 0x0ede, 0x0ef4, 0x0f0a, 0x0f20, 0x0f36, 0x0f4c,
	0x0f62, 0x0f79, 0x0f8f, 0x0fa5, 0x0fbc, 0x0fd2, 0x0fe9, 0x0fff,
	0x0fff
};
static u32 g_gamma_1_5[DEGAMMA_COEF_LEN] = {
	0x0000, 0x0000, 0x0003, 0x0008, 0x000d, 0x0012, 0x0019, 0x001f,
	0x0026, 0x002d, 0x0035, 0x003d, 0x0045, 0x004d, 0x0055, 0x005e,
	0x0067, 0x0070, 0x0079, 0x0082, 0x008c, 0x0096, 0x009f, 0x00a9,
	0x00b3, 0x00be, 0x00c8, 0x00d2, 0x00dd, 0x00e8, 0x00f3, 0x00fe,
	0x0109, 0x0114, 0x011f, 0x012a, 0x0136, 0x0141, 0x014d, 0x0159,
	0x0165, 0x0170, 0x017d, 0x0189, 0x0195, 0x01a1, 0x01ad, 0x01ba,
	0x01c6, 0x01d3, 0x01e0, 0x01ed, 0x01f9, 0x0206, 0x0213, 0x0220,
	0x022d, 0x023b, 0x0248, 0x0255, 0x0263, 0x0270, 0x027e, 0x028b,
	0x0299, 0x02a7, 0x02b5, 0x02c3, 0x02d1, 0x02df, 0x02ed, 0x02fb,
	0x0309, 0x0317, 0x0326, 0x0334, 0x0342, 0x0351, 0x035f, 0x036e,
	0x037d, 0x038b, 0x039a, 0x03a9, 0x03b8, 0x03c7, 0x03d6, 0x03e5,
	0x03f4, 0x0403, 0x0412, 0x0421, 0x0431, 0x0440, 0x0450, 0x045f,
	0x03a3, 0x03b2, 0x03c1, 0x03d0, 0x03df, 0x03ee, 0x03fd,
	0x040c, 0x041b, 0x042b, 0x043a, 0x0449, 0x0459, 0x0469, 0x0478,
	0x0488, 0x0498, 0x04a8, 0x04b8, 0x04c8, 0x04d8, 0x04e8, 0x04f9,
	0x0509, 0x0519, 0x052a, 0x053b, 0x054b, 0x055c, 0x056d, 0x057d,
	0x058e, 0x059f, 0x05b0, 0x05c1, 0x05d3, 0x05e4, 0x05f5, 0x0606,
	0x0618, 0x0629, 0x063b, 0x064d, 0x065e, 0x0670, 0x0682, 0x0694,
	0x06a6, 0x06b8, 0x06ca, 0x06dc, 0x06ee, 0x0700, 0x0713, 0x0725,
	0x0737, 0x074a, 0x075d, 0x076f, 0x0782, 0x0795, 0x07a7, 0x07ba,
	0x07cd, 0x07e0, 0x07f3, 0x0806, 0x081a, 0x082d, 0x0840, 0x0853,
	0x0867, 0x087a, 0x088e, 0x08a1, 0x08b5, 0x08c9, 0x08dc, 0x08f0,
	0x0904, 0x0918, 0x092c, 0x0940, 0x0954, 0x0968, 0x097d, 0x0991,
	0x09a5, 0x09ba, 0x09ce, 0x09e2, 0x09f7, 0x0a0c, 0x0a20, 0x0a35,
	0x0a4a, 0x0a5f, 0x0a73, 0x0a88, 0x0a9d, 0x0ab2, 0x0ac7, 0x0add,
	0x0af2, 0x0b07, 0x0b1c, 0x0b32, 0x0b47, 0x0b5d, 0x0b72, 0x0b88,
	0x0b9d, 0x0bb3, 0x0bc9, 0x0bdf, 0x0bf4, 0x0c0a, 0x0c20, 0x0c36,
	0x0c4c, 0x0c62, 0x0c78, 0x0c8f, 0x0ca5, 0x0cbb, 0x0cd2, 0x0ce8,
	0x0cfe, 0x0d15, 0x0d2b, 0x0d42, 0x0d59, 0x0d6f, 0x0d86, 0x0d9d,
	0x0db4, 0x0dcb, 0x0de2, 0x0df9, 0x0e10, 0x0e27, 0x0e3e, 0x0e55,
	0x0e6c, 0x0e84, 0x0e9b, 0x0eb2, 0x0eca, 0x0ee1, 0x0ef9, 0x0f10,
	0x0f28, 0x0f40, 0x0f58, 0x0f6f, 0x0f87, 0x0f9f, 0x0fb7, 0x0fcf,
	0x0fe7, 0x0fff
};
static u32 g_gamma_1_5_std[DEGAMMA_COEF_LEN] = {
	0x0000, 0x0001, 0x0003, 0x0005, 0x0008, 0x000b, 0x000f, 0x0013,
	0x0017, 0x001b, 0x0020, 0x0025, 0x002a, 0x002f, 0x0035, 0x003a,
	0x0040, 0x0046, 0x004d, 0x0053, 0x005a, 0x0061, 0x0068, 0x006f,
	0x0076, 0x007e, 0x0085, 0x008d, 0x0095, 0x009d, 0x00a5, 0x00ae,
	0x00b6, 0x00bf, 0x00c7, 0x00d0, 0x00d9, 0x00e2, 0x00ec, 0x00f5,
	0x00fe, 0x0108, 0x0112, 0x011c, 0x0126, 0x0130, 0x013a, 0x0144,
	0x014e, 0x0159, 0x0164, 0x016e, 0x0179, 0x0184, 0x018f, 0x019a,
	0x01a5, 0x01b1, 0x01bc, 0x01c8, 0x01d3, 0x01df, 0x01eb, 0x01f7,
	0x0203, 0x020f, 0x021b, 0x0228, 0x0234, 0x0240, 0x024d, 0x025a,
	0x0266, 0x0273, 0x0280, 0x028d, 0x029a, 0x02a7, 0x02b5, 0x02c2,
	0x02d0, 0x02dd, 0x02eb, 0x02f8, 0x0306, 0x0314, 0x0322, 0x0330,
	0x033e, 0x034c, 0x035b, 0x0369, 0x0377, 0x0386, 0x0395, 0x03a3,
	0x03b2, 0x03c1, 0x03d0, 0x03df, 0x03ee, 0x03fd, 0x040c, 0x041b,
	0x042b, 0x043a, 0x0449, 0x0459, 0x0469, 0x0478, 0x0488, 0x0498,
	0x04a8, 0x04b8, 0x04c8, 0x04d8, 0x04e8, 0x04f9, 0x0509, 0x0519,
	0x052a, 0x053b, 0x054b, 0x055c, 0x056d, 0x057d, 0x058e, 0x059f,
	0x05b0, 0x05c1, 0x05d3, 0x05e4, 0x05f5, 0x0606, 0x0618, 0x0629,
	0x063b, 0x064d, 0x065e, 0x0670, 0x0682, 0x0694, 0x06a6, 0x06b8,
	0x06ca, 0x06dc, 0x06ee, 0x0700, 0x0713, 0x0725, 0x0737, 0x074a,
	0x075d, 0x076f, 0x0782, 0x0795, 0x07a7, 0x07ba, 0x07cd, 0x07e0,
	0x07f3, 0x0806, 0x081a, 0x082d, 0x0840, 0x0853, 0x0867, 0x087a,
	0x088e, 0x08a1, 0x08b5, 0x08c9, 0x08dc, 0x08f0, 0x0904, 0x0918,
	0x092c, 0x0940, 0x0954, 0x0968, 0x097d, 0x0991, 0x09a5, 0x09ba,
	0x09ce, 0x09e2, 0x09f7, 0x0a0c, 0x0a20, 0x0a35, 0x0a4a, 0x0a5f,
	0x0a73, 0x0a88, 0x0a9d, 0x0ab2, 0x0ac7, 0x0add, 0x0af2, 0x0b07,
	0x0b1c, 0x0b32, 0x0b47, 0x0b5d, 0x0b72, 0x0b88, 0x0b9d, 0x0bb3,
	0x0bc9, 0x0bdf, 0x0bf4, 0x0c0a, 0x0c20, 0x0c36, 0x0c4c, 0x0c62,
	0x0c78, 0x0c8f, 0x0ca5, 0x0cbb, 0x0cd2, 0x0ce8, 0x0cfe, 0x0d15,
	0x0d2b, 0x0d42, 0x0d59, 0x0d6f, 0x0d86, 0x0d9d, 0x0db4, 0x0dcb,
	0x0de2, 0x0df9, 0x0e10, 0x0e27, 0x0e3e, 0x0e55, 0x0e6c, 0x0e84,
	0x0e9b, 0x0eb2, 0x0eca, 0x0ee1, 0x0ef9, 0x0f10, 0x0f28, 0x0f40,
	0x0f58, 0x0f6f, 0x0f87, 0x0f9f, 0x0fb7, 0x0fcf, 0x0fe7, 0x0fff,
	0x0fff
};

static u32 g_gamma_1_6[DEGAMMA_COEF_LEN] = {
	0x0000, 0x0001, 0x0002, 0x0003, 0x0005, 0x0008, 0x000a, 0x000d,
	0x0010, 0x0013, 0x0017, 0x001b, 0x001f, 0x0023, 0x0027, 0x002c,
	0x0031, 0x0036, 0x003b, 0x0040, 0x0046, 0x004b, 0x0051, 0x0057,
	0x005d, 0x0064, 0x006a, 0x0071, 0x0077, 0x007e, 0x0085, 0x008d,
	0x0094, 0x009b, 0x00a3, 0x00ab, 0x00b3, 0x00bb, 0x00c3, 0x00cb,
	0x00d3, 0x00dc, 0x00e5, 0x00ed, 0x00f6, 0x00ff, 0x0108, 0x0112,
	0x011b, 0x0124, 0x012e, 0x0138, 0x0142, 0x014c, 0x0156, 0x0160,
	0x016a, 0x0175, 0x017f, 0x018a, 0x0194, 0x019f, 0x01aa, 0x01b5,
	0x01c0, 0x01cc, 0x01d7, 0x01e3, 0x01ee, 0x01fa, 0x0206, 0x0211,
	0x021d, 0x0229, 0x0236, 0x0242, 0x024e, 0x025b, 0x0267, 0x0274,
	0x0281, 0x028e, 0x029b, 0x02a8, 0x02b5, 0x02c2, 0x02cf, 0x02dd,
	0x02ea, 0x02f8, 0x0306, 0x0314, 0x0321, 0x032f, 0x033d, 0x034c,
	0x035a, 0x0368, 0x0377, 0x0385, 0x0394, 0x03a2, 0x03b1, 0x03c0,
	0x03cf, 0x03de, 0x03ed, 0x03fc, 0x040c, 0x041b, 0x042b, 0x043a,
	0x044a, 0x045a, 0x0469, 0x0479, 0x0489, 0x0499, 0x04a9, 0x04ba,
	0x04ca, 0x04da, 0x04eb, 0x04fb, 0x050c, 0x051d, 0x052e, 0x053e,
	0x054f, 0x0560, 0x0571, 0x0583, 0x0594, 0x05a5, 0x05b7, 0x05c8,
	0x05da, 0x05eb, 0x05fd, 0x060f, 0x0621, 0x0633, 0x0645, 0x0657,
	0x0669, 0x067c, 0x068e, 0x06a0, 0x06b3, 0x06c5, 0x06d8, 0x06eb,
	0x06fe, 0x0710, 0x0723, 0x0736, 0x0749, 0x075d, 0x0770, 0x0783,
	0x0797, 0x07aa, 0x07be, 0x07d1, 0x07e5, 0x07f9, 0x080c, 0x0820,
	0x0834, 0x0848, 0x085c, 0x0871, 0x0885, 0x0899, 0x08ae, 0x08c2,
	0x08d7, 0x08eb, 0x0900, 0x0915, 0x0929, 0x093e, 0x0953, 0x0968,
	0x097d, 0x0993, 0x09a8, 0x09bd, 0x09d2, 0x09e8, 0x09fd, 0x0a13,
	0x0a29, 0x0a3e, 0x0a54, 0x0a6a, 0x0a80, 0x0a96, 0x0aac, 0x0ac2,
	0x0ad8, 0x0aee, 0x0b05, 0x0b1b, 0x0b31, 0x0b48, 0x0b5f, 0x0b75,
	0x0b8c, 0x0ba3, 0x0bba, 0x0bd0, 0x0be7, 0x0bfe, 0x0c16, 0x0c2d,
	0x0c44, 0x0c5b, 0x0c73, 0x0c8a, 0x0ca1, 0x0cb9, 0x0cd1, 0x0ce8,
	0x0d00, 0x0d18, 0x0d30, 0x0d48, 0x0d60, 0x0d78, 0x0d90, 0x0da8,
	0x0dc0, 0x0dd9, 0x0df1, 0x0e09, 0x0e22, 0x0e3a, 0x0e53, 0x0e6c,
	0x0e84, 0x0e9d, 0x0eb6, 0x0ecf, 0x0ee8, 0x0f01, 0x0f1a, 0x0f33,
	0x0f4d, 0x0f66, 0x0f7f, 0x0f99, 0x0fb2, 0x0fcc, 0x0fe5, 0x0fff,
	0x0fff
};
static u32 g_gamma_1_7[DEGAMMA_COEF_LEN] = {
	0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0005, 0x0007, 0x0009,
	0x000b, 0x000e, 0x0011, 0x0014, 0x0017, 0x001a, 0x001d, 0x0021,
	0x0025, 0x0029, 0x002d, 0x0032, 0x0036, 0x003b, 0x0040, 0x0045,
	0x004a, 0x004f, 0x0054, 0x005a, 0x0060, 0x0066, 0x006c, 0x0072,
	0x0078, 0x007f, 0x0085, 0x008c, 0x0093, 0x009a, 0x00a1, 0x00a8,
	0x00b0, 0x00b7, 0x00bf, 0x00c7, 0x00cf, 0x00d7, 0x00df, 0x00e7,
	0x00ef, 0x00f8, 0x0101, 0x0109, 0x0112, 0x011b, 0x0125, 0x012e,
	0x0137, 0x0141, 0x014a, 0x0154, 0x015e, 0x0168, 0x0172, 0x017c,
	0x0187, 0x0191, 0x019b, 0x01a6, 0x01b1, 0x01bc, 0x01c7, 0x01d2,
	0x01dd, 0x01e8, 0x01f4, 0x01ff, 0x020b, 0x0217, 0x0223, 0x022f,
	0x023b, 0x0247, 0x0253, 0x0260, 0x026c, 0x0279, 0x0285, 0x0292,
	0x029f, 0x02ac, 0x02b9, 0x02c6, 0x02d4, 0x02e1, 0x02ef, 0x02fc,
	0x030a, 0x0318, 0x0326, 0x0334, 0x0342, 0x0350, 0x035e, 0x036d,
	0x037b, 0x038a, 0x0399, 0x03a8, 0x03b7, 0x03c6, 0x03d5, 0x03e4,
	0x03f3, 0x0403, 0x0412, 0x0422, 0x0431, 0x0441, 0x0451, 0x0461,
	0x0471, 0x0481, 0x0491, 0x04a2, 0x04b2, 0x04c3, 0x04d3, 0x04e4,
	0x04f5, 0x0506, 0x0517, 0x0528, 0x0539, 0x054a, 0x055c, 0x056d,
	0x057f, 0x0590, 0x05a2, 0x05b4, 0x05c6, 0x05d8, 0x05ea, 0x05fc,
	0x060e, 0x0620, 0x0633, 0x0645, 0x0658, 0x066b, 0x067d, 0x0690,
	0x06a3, 0x06b6, 0x06c9, 0x06dd, 0x06f0, 0x0703, 0x0717, 0x072a,
	0x073e, 0x0752, 0x0766, 0x077a, 0x078e, 0x07a2, 0x07b6, 0x07ca,
	0x07de, 0x07f3, 0x0807, 0x081c, 0x0831, 0x0845, 0x085a, 0x086f,
	0x0884, 0x0899, 0x08af, 0x08c4, 0x08d9, 0x08ef, 0x0904, 0x091a,
	0x092f, 0x0945, 0x095b, 0x0971, 0x0987, 0x099d, 0x09b3, 0x09c9,
	0x09e0, 0x09f6, 0x0a0d, 0x0a23, 0x0a3a, 0x0a51, 0x0a68, 0x0a7e,
	0x0a95, 0x0aad, 0x0ac4, 0x0adb, 0x0af2, 0x0b0a, 0x0b21, 0x0b39,
	0x0b50, 0x0b68, 0x0b80, 0x0b98, 0x0bb0, 0x0bc8, 0x0be0, 0x0bf8,
	0x0c10, 0x0c29, 0x0c41, 0x0c59, 0x0c72, 0x0c8b, 0x0ca3, 0x0cbc,
	0x0cd5, 0x0cee, 0x0d07, 0x0d20, 0x0d3a, 0x0d53, 0x0d6c, 0x0d86,
	0x0d9f, 0x0db9, 0x0dd2, 0x0dec, 0x0e06, 0x0e20, 0x0e3a, 0x0e54,
	0x0e6e, 0x0e88, 0x0ea2, 0x0ebd, 0x0ed7, 0x0ef2, 0x0f0c, 0x0f27,
	0x0f42, 0x0f5d, 0x0f77, 0x0f92, 0x0fad, 0x0fc9, 0x0fe4, 0x0fff,
	0x0fff
};
static u32 g_gamma_1_8[DEGAMMA_COEF_LEN] = {
	0x0000, 0x0000, 0x0001, 0x0001, 0x0002, 0x0003, 0x0005, 0x0006,
	0x0008, 0x000a, 0x000c, 0x000e, 0x0011, 0x0013, 0x0016, 0x0019,
	0x001c, 0x001f, 0x0023, 0x0026, 0x002a, 0x002e, 0x0032, 0x0036,
	0x003a, 0x003f, 0x0043, 0x0048, 0x004d, 0x0052, 0x0057, 0x005c,
	0x0062, 0x0067, 0x006d, 0x0073, 0x0079, 0x007f, 0x0085, 0x008b,
	0x0092, 0x0099, 0x009f, 0x00a6, 0x00ad, 0x00b4, 0x00bc, 0x00c3,
	0x00cb, 0x00d2, 0x00da, 0x00e2, 0x00ea, 0x00f2, 0x00fa, 0x0103,
	0x010b, 0x0114, 0x011d, 0x0126, 0x012f, 0x0138, 0x0141, 0x014b,
	0x0154, 0x015e, 0x0167, 0x0171, 0x017b, 0x0185, 0x0190, 0x019a,
	0x01a4, 0x01af, 0x01ba, 0x01c4, 0x01cf, 0x01da, 0x01e6, 0x01f1,
	0x01fc, 0x0208, 0x0213, 0x021f, 0x022b, 0x0237, 0x0243, 0x024f,
	0x025b, 0x0268, 0x0274, 0x0281, 0x028e, 0x029a, 0x02a7, 0x02b4,
	0x02c2, 0x02cf, 0x02dc, 0x02ea, 0x02f7, 0x0305, 0x0313, 0x0321,
	0x032f, 0x033d, 0x034b, 0x035a, 0x0368, 0x0377, 0x0386, 0x0394,
	0x03a3, 0x03b2, 0x03c1, 0x03d1, 0x03e0, 0x03ef, 0x03ff, 0x040f,
	0x041e, 0x042e, 0x043e, 0x044e, 0x045f, 0x046f, 0x047f, 0x0490,
	0x04a0, 0x04b1, 0x04c2, 0x04d3, 0x04e4, 0x04f5, 0x0506, 0x0517,
	0x0529, 0x053a, 0x054c, 0x055e, 0x0570, 0x0582, 0x0594, 0x05a6,
	0x05b8, 0x05ca, 0x05dd, 0x05ef, 0x0602, 0x0615, 0x0628, 0x063b,
	0x064e, 0x0661, 0x0674, 0x0687, 0x069b, 0x06ae, 0x06c2, 0x06d6,
	0x06ea, 0x06fe, 0x0712, 0x0726, 0x073a, 0x074e, 0x0763, 0x0777,
	0x078c, 0x07a1, 0x07b6, 0x07cb, 0x07e0, 0x07f5, 0x080a, 0x081f,
	0x0835, 0x084a, 0x0860, 0x0876, 0x088c, 0x08a2, 0x08b8, 0x08ce,
	0x08e4, 0x08fa, 0x0911, 0x0927, 0x093e, 0x0954, 0x096b, 0x0982,
	0x0999, 0x09b0, 0x09c7, 0x09df, 0x09f6, 0x0a0d, 0x0a25, 0x0a3d,
	0x0a54, 0x0a6c, 0x0a84, 0x0a9c, 0x0ab4, 0x0acd, 0x0ae5, 0x0afd,
	0x0b16, 0x0b2e, 0x0b47, 0x0b60, 0x0b79, 0x0b92, 0x0bab, 0x0bc4,
	0x0bdd, 0x0bf7, 0x0c10, 0x0c2a, 0x0c43, 0x0c5d, 0x0c77, 0x0c91,
	0x0cab, 0x0cc5, 0x0cdf, 0x0cf9, 0x0d14, 0x0d2e, 0x0d49, 0x0d64,
	0x0d7e, 0x0d99, 0x0db4, 0x0dcf, 0x0dea, 0x0e05, 0x0e21, 0x0e3c,
	0x0e58, 0x0e73, 0x0e8f, 0x0eab, 0x0ec7, 0x0ee2, 0x0eff, 0x0f1b,
	0x0f37, 0x0f53, 0x0f70, 0x0f8c, 0x0fa9, 0x0fc5, 0x0fe2, 0x0fff,
	0x0fff
};
static u32 g_gamma_1_9[DEGAMMA_COEF_LEN] = {
	0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0002, 0x0003, 0x0004,
	0x0006, 0x0007, 0x0009, 0x000a, 0x000c, 0x000e, 0x0010, 0x0013,
	0x0015, 0x0018, 0x001b, 0x001d, 0x0020, 0x0024, 0x0027, 0x002a,
	0x002e, 0x0032, 0x0035, 0x0039, 0x003e, 0x0042, 0x0046, 0x004b,
	0x004f, 0x0054, 0x0059, 0x005e, 0x0063, 0x0069, 0x006e, 0x0074,
	0x0079, 0x007f, 0x0085, 0x008b, 0x0091, 0x0098, 0x009e, 0x00a5,
	0x00ab, 0x00b2, 0x00b9, 0x00c0, 0x00c8, 0x00cf, 0x00d6, 0x00de,
	0x00e6, 0x00ee, 0x00f6, 0x00fe, 0x0106, 0x010e, 0x0117, 0x011f,
	0x0128, 0x0131, 0x013a, 0x0143, 0x014c, 0x0156, 0x015f, 0x0169,
	0x0172, 0x017c, 0x0186, 0x0190, 0x019b, 0x01a5, 0x01af, 0x01ba,
	0x01c5, 0x01cf, 0x01da, 0x01e5, 0x01f1, 0x01fc, 0x0207, 0x0213,
	0x021e, 0x022a, 0x0236, 0x0242, 0x024e, 0x025a, 0x0267, 0x0273,
	0x0280, 0x028d, 0x029a, 0x02a6, 0x02b4, 0x02c1, 0x02ce, 0x02dc,
	0x02e9, 0x02f7, 0x0305, 0x0312, 0x0320, 0x032f, 0x033d, 0x034b,
	0x035a, 0x0368, 0x0377, 0x0386, 0x0395, 0x03a4, 0x03b3, 0x03c2,
	0x03d2, 0x03e1, 0x03f1, 0x0401, 0x0411, 0x0421, 0x0431, 0x0441,
	0x0451, 0x0462, 0x0472, 0x0483, 0x0494, 0x04a5, 0x04b6, 0x04c7,
	0x04d8, 0x04ea, 0x04fb, 0x050d, 0x051f, 0x0530, 0x0542, 0x0554,
	0x0567, 0x0579, 0x058b, 0x059e, 0x05b1, 0x05c3, 0x05d6, 0x05e9,
	0x05fc, 0x060f, 0x0623, 0x0636, 0x064a, 0x065d, 0x0671, 0x0685,
	0x0699, 0x06ad, 0x06c1, 0x06d6, 0x06ea, 0x06ff, 0x0713, 0x0728,
	0x073d, 0x0752, 0x0767, 0x077d, 0x0792, 0x07a7, 0x07bd, 0x07d3,
	0x07e8, 0x07fe, 0x0814, 0x082a, 0x0841, 0x0857, 0x086e, 0x0884,
	0x089b, 0x08b2, 0x08c9, 0x08e0, 0x08f7, 0x090e, 0x0925, 0x093d,
	0x0954, 0x096c, 0x0984, 0x099c, 0x09b4, 0x09cc, 0x09e4, 0x09fd,
	0x0a15, 0x0a2e, 0x0a46, 0x0a5f, 0x0a78, 0x0a91, 0x0aaa, 0x0ac3,
	0x0add, 0x0af6, 0x0b10, 0x0b29, 0x0b43, 0x0b5d, 0x0b77, 0x0b91,
	0x0bab, 0x0bc6, 0x0be0, 0x0bfb, 0x0c15, 0x0c30, 0x0c4b, 0x0c66,
	0x0c81, 0x0c9c, 0x0cb8, 0x0cd3, 0x0cef, 0x0d0a, 0x0d26, 0x0d42,
	0x0d5e, 0x0d7a, 0x0d96, 0x0db2, 0x0dcf, 0x0deb, 0x0e08, 0x0e25,
	0x0e41, 0x0e5e, 0x0e7b, 0x0e99, 0x0eb6, 0x0ed3, 0x0ef1, 0x0f0e,
	0x0f2c, 0x0f4a, 0x0f68, 0x0f86, 0x0fa4, 0x0fc2, 0x0fe1, 0x0fff,
	0x0fff
};
static u32 g_gamma_2_0[DEGAMMA_COEF_LEN] = {
	0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0001, 0x0002, 0x0002,
	0x0003, 0x0004, 0x0005, 0x0006, 0x0008, 0x0009, 0x000b, 0x000c,
	0x000e, 0x0010, 0x0012, 0x0014, 0x0017, 0x0019, 0x001c, 0x001e,
	0x0021, 0x0024, 0x0027, 0x002b, 0x002e, 0x0031, 0x0035, 0x0039,
	0x003d, 0x0040, 0x0045, 0x0049, 0x004d, 0x0052, 0x0056, 0x005b,
	0x0060, 0x0065, 0x006a, 0x006f, 0x0074, 0x007a, 0x0080, 0x0085,
	0x008b, 0x0091, 0x0097, 0x009d, 0x00a4, 0x00aa, 0x00b1, 0x00b8,
	0x00bf, 0x00c5, 0x00cd, 0x00d4, 0x00db, 0x00e3, 0x00ea, 0x00f2,
	0x00fa, 0x0102, 0x010a, 0x0112, 0x011b, 0x0123, 0x012c, 0x0135,
	0x013d, 0x0146, 0x0150, 0x0159, 0x0162, 0x016c, 0x0175, 0x017f,
	0x0189, 0x0193, 0x019d, 0x01a7, 0x01b2, 0x01bc, 0x01c7, 0x01d2,
	0x01dd, 0x01e8, 0x01f3, 0x01fe, 0x020a, 0x0215, 0x0221, 0x022c,
	0x0238, 0x0244, 0x0251, 0x025d, 0x0269, 0x0276, 0x0282, 0x028f,
	0x029c, 0x02a9, 0x02b6, 0x02c4, 0x02d1, 0x02df, 0x02ec, 0x02fa,
	0x0308, 0x0316, 0x0324, 0x0332, 0x0341, 0x034f, 0x035e, 0x036d,
	0x037c, 0x038b, 0x039a, 0x03a9, 0x03b9, 0x03c8, 0x03d8, 0x03e8,
	0x03f8, 0x0408, 0x0418, 0x0428, 0x0439, 0x0449, 0x045a, 0x046b,
	0x047c, 0x048d, 0x049e, 0x04af, 0x04c1, 0x04d2, 0x04e4, 0x04f6,
	0x0508, 0x051a, 0x052c, 0x053e, 0x0551, 0x0563, 0x0576, 0x0589,
	0x059c, 0x05af, 0x05c2, 0x05d6, 0x05e9, 0x05fd, 0x0610, 0x0624,
	0x0638, 0x064c, 0x0660, 0x0675, 0x0689, 0x069e, 0x06b3, 0x06c7,
	0x06dc, 0x06f1, 0x0707, 0x071c, 0x0731, 0x0747, 0x075d, 0x0773,
	0x0789, 0x079f, 0x07b5, 0x07cb, 0x07e2, 0x07f8, 0x080f, 0x0826,
	0x083d, 0x0854, 0x086b, 0x0883, 0x089a, 0x08b2, 0x08ca, 0x08e1,
	0x08f9, 0x0912, 0x092a, 0x0942, 0x095b, 0x0973, 0x098c, 0x09a5,
	0x09be, 0x09d7, 0x09f0, 0x0a0a, 0x0a23, 0x0a3d, 0x0a57, 0x0a70,
	0x0a8a, 0x0aa5, 0x0abf, 0x0ad9, 0x0af4, 0x0b0e, 0x0b29, 0x0b44,
	0x0b5f, 0x0b7a, 0x0b95, 0x0bb1, 0x0bcc, 0x0be8, 0x0c04, 0x0c20,
	0x0c3c, 0x0c58, 0x0c74, 0x0c91, 0x0cad, 0x0cca, 0x0ce7, 0x0d03,
	0x0d20, 0x0d3e, 0x0d5b, 0x0d78, 0x0d96, 0x0db3, 0x0dd1, 0x0def,
	0x0e0d, 0x0e2b, 0x0e4a, 0x0e68, 0x0e87, 0x0ea5, 0x0ec4, 0x0ee3,
	0x0f02, 0x0f21, 0x0f41, 0x0f60, 0x0f80, 0x0f9f, 0x0fbf, 0x0fdf,
	0x0fff
};
static u32 g_gamma_2_1[DEGAMMA_COEF_LEN] = {
	0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0001, 0x0002, 0x0002,
	0x0003, 0x0004, 0x0005, 0x0006, 0x0007, 0x0008, 0x0009, 0x000b,
	0x000c, 0x000e, 0x0010, 0x0012, 0x0014, 0x0016, 0x0018, 0x001a,
	0x001d, 0x001f, 0x0022, 0x0025, 0x0028, 0x002b, 0x002e, 0x0031,
	0x0034, 0x0038, 0x003c, 0x003f, 0x0043, 0x0047, 0x004b, 0x004f,
	0x0054, 0x0058, 0x005d, 0x0061, 0x0066, 0x006b, 0x0070, 0x0075,
	0x007b, 0x0080, 0x0086, 0x008b, 0x0091, 0x0097, 0x009d, 0x00a3,
	0x00aa, 0x00b0, 0x00b7, 0x00bd, 0x00c4, 0x00cb, 0x00d2, 0x00d9,
	0x00e1, 0x00e8, 0x00f0, 0x00f7, 0x00ff, 0x0107, 0x010f, 0x0117,
	0x0120, 0x0128, 0x0131, 0x0139, 0x0142, 0x014b, 0x0154, 0x015e,
	0x0167, 0x0170, 0x017a, 0x0184, 0x018e, 0x0198, 0x01a2, 0x01ac,
	0x01b6, 0x01c1, 0x01cc, 0x01d6, 0x01e1, 0x01ec, 0x01f8, 0x0203,
	0x020e, 0x021a, 0x0226, 0x0232, 0x023d, 0x024a, 0x0256, 0x0262,
	0x026f, 0x027b, 0x0288, 0x0295, 0x02a2, 0x02af, 0x02bd, 0x02ca,
	0x02d8, 0x02e5, 0x02f3, 0x0301, 0x030f, 0x031d, 0x032c, 0x033a,
	0x0349, 0x0358, 0x0367, 0x0376, 0x0385, 0x0394, 0x03a4, 0x03b3,
	0x03c3, 0x03d3, 0x03e3, 0x03f3, 0x0403, 0x0414, 0x0424, 0x0435,
	0x0446, 0x0457, 0x0468, 0x0479, 0x048a, 0x049c, 0x04ae, 0x04bf,
	0x04d1, 0x04e3, 0x04f6, 0x0508, 0x051a, 0x052d, 0x0540, 0x0553,
	0x0566, 0x0579, 0x058c, 0x05a0, 0x05b3, 0x05c7, 0x05db, 0x05ef,
	0x0603, 0x0617, 0x062b, 0x0640, 0x0655, 0x0669, 0x067e, 0x0694,
	0x06a9, 0x06be, 0x06d4, 0x06e9, 0x06ff, 0x0715, 0x072b, 0x0741,
	0x0758, 0x076e, 0x0785, 0x079c, 0x07b3, 0x07ca, 0x07e1, 0x07f8,
	0x0810, 0x0827, 0x083f, 0x0857, 0x086f, 0x0887, 0x08a0, 0x08b8,
	0x08d1, 0x08e9, 0x0902, 0x091b, 0x0934, 0x094e, 0x0967, 0x0981,
	0x099b, 0x09b4, 0x09ce, 0x09e9, 0x0a03, 0x0a1d, 0x0a38, 0x0a53,
	0x0a6e, 0x0a89, 0x0aa4, 0x0abf, 0x0adb, 0x0af6, 0x0b12, 0x0b2e,
	0x0b4a, 0x0b66, 0x0b82, 0x0b9f, 0x0bbb, 0x0bd8, 0x0bf5, 0x0c12,
	0x0c2f, 0x0c4c, 0x0c6a, 0x0c88, 0x0ca5, 0x0cc3, 0x0ce1, 0x0cff,
	0x0d1e, 0x0d3c, 0x0d5b, 0x0d7a, 0x0d98, 0x0db7, 0x0dd7, 0x0df6,
	0x0e15, 0x0e35, 0x0e55, 0x0e75, 0x0e95, 0x0eb5, 0x0ed5, 0x0ef6,
	0x0f16, 0x0f37, 0x0f58, 0x0f79, 0x0f9a, 0x0fbc, 0x0fdd, 0x0fff,
	0x0fff
};
static u32 g_gamma_2_2[DEGAMMA_COEF_LEN] = {
	0x0000, 0x0001, 0x0002, 0x0004, 0x0005, 0x0006, 0x0007, 0x0009,
	0x000a, 0x000b, 0x000c, 0x000e, 0x000f, 0x0010, 0x0012, 0x0013,
	0x0015, 0x0017, 0x0019, 0x001b, 0x001d, 0x001f, 0x0021, 0x0023,
	0x0025, 0x0028, 0x002a, 0x002d, 0x002f, 0x0032, 0x0035, 0x0038,
	0x003b, 0x003e, 0x0041, 0x0045, 0x0048, 0x004b, 0x004f, 0x0053,
	0x0057, 0x005a, 0x005e, 0x0063, 0x0067, 0x006b, 0x006f, 0x0074,
	0x0079, 0x007d, 0x0082, 0x0087, 0x008c, 0x0091, 0x0097, 0x009c,
	0x00a1, 0x00a7, 0x00ad, 0x00b2, 0x00b8, 0x00be, 0x00c5, 0x00cb,
	0x00d1, 0x00d8, 0x00de, 0x00e5, 0x00ec, 0x00f3, 0x00fa, 0x0101,
	0x0108, 0x0110, 0x0117, 0x011f, 0x0127, 0x012f, 0x0137, 0x013f,
	0x0147, 0x0150, 0x0158, 0x0161, 0x016a, 0x0173, 0x017c, 0x0185,
	0x018e, 0x0198, 0x01a1, 0x01ab, 0x01b5, 0x01bf, 0x01c9, 0x01d3,
	0x01dd, 0x01e8, 0x01f2, 0x01fd, 0x0208, 0x0213, 0x021e, 0x0229,
	0x0235, 0x0240, 0x024c, 0x0258, 0x0264, 0x0270, 0x027c, 0x0289,
	0x0295, 0x02a2, 0x02af, 0x02bb, 0x02c9, 0x02d6, 0x02e3, 0x02f1,
	0x02fe, 0x030c, 0x031a, 0x0328, 0x0336, 0x0345, 0x0353, 0x0362,
	0x0371, 0x0380, 0x038f, 0x039e, 0x03ad, 0x03bd, 0x03cd, 0x03dd,
	0x03ed, 0x03fd, 0x040d, 0x041d, 0x042e, 0x043f, 0x0450, 0x0461,
	0x0472, 0x0483, 0x0495, 0x04a6, 0x04b8, 0x04ca, 0x04dc, 0x04ef,
	0x0501, 0x0514, 0x0526, 0x0539, 0x054c, 0x0560, 0x0573, 0x0587,
	0x059a, 0x05ae, 0x05c2, 0x05d6, 0x05eb, 0x05ff, 0x0614, 0x0629,
	0x063e, 0x0653, 0x0668, 0x067e, 0x0693, 0x06a9, 0x06bf, 0x06d5,
	0x06eb, 0x0702, 0x0718, 0x072f, 0x0746, 0x075d, 0x0775, 0x078c,
	0x07a4, 0x07bb, 0x07d3, 0x07eb, 0x0804, 0x081c, 0x0835, 0x084e,
	0x0867, 0x0880, 0x0899, 0x08b3, 0x08cc, 0x08e6, 0x0900, 0x091a,
	0x0935, 0x094f, 0x096a, 0x0985, 0x09a0, 0x09bb, 0x09d6, 0x09f2,
	0x0a0d, 0x0a29, 0x0a45, 0x0a62, 0x0a7e, 0x0a9b, 0x0ab8, 0x0ad5,
	0x0af2, 0x0b0f, 0x0b2c, 0x0b4a, 0x0b68, 0x0b86, 0x0ba4, 0x0bc3,
	0x0be1, 0x0c00, 0x0c1f, 0x0c3e, 0x0c5d, 0x0c7d, 0x0c9c, 0x0cbc,
	0x0cdc, 0x0cfd, 0x0d1d, 0x0d3e, 0x0d5e, 0x0d7f, 0x0da0, 0x0dc2,
	0x0de3, 0x0e05, 0x0e27, 0x0e49, 0x0e6b, 0x0e8d, 0x0eb0, 0x0ed3,
	0x0ef6, 0x0f19, 0x0f3c, 0x0f60, 0x0f84, 0x0fa8, 0x0fcc, 0x0ff0,
	0x0fff
};
static u32 g_gamma_2_3[DEGAMMA_COEF_LEN] = {
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0001,
	0x0001, 0x0002, 0x0002, 0x0003, 0x0004, 0x0004, 0x0005, 0x0006,
	0x0007, 0x0008, 0x0009, 0x000a, 0x000c, 0x000d, 0x000f, 0x0010,
	0x0012, 0x0014, 0x0015, 0x0017, 0x0019, 0x001c, 0x001e, 0x0020,
	0x0023, 0x0025, 0x0028, 0x002b, 0x002d, 0x0030, 0x0033, 0x0037,
	0x003a, 0x003d, 0x0041, 0x0044, 0x0048, 0x004c, 0x0050, 0x0054,
	0x0058, 0x005c, 0x0061, 0x0065, 0x006a, 0x006e, 0x0073, 0x0078,
	0x007d, 0x0083, 0x0088, 0x008d, 0x0093, 0x0099, 0x009e, 0x00a4,
	0x00aa, 0x00b1, 0x00b7, 0x00bd, 0x00c4, 0x00cb, 0x00d1, 0x00d8,
	0x00df, 0x00e7, 0x00ee, 0x00f5, 0x00fd, 0x0105, 0x010d, 0x0115,
	0x011d, 0x0125, 0x012d, 0x0136, 0x013e, 0x0147, 0x0150, 0x0159,
	0x0162, 0x016c, 0x0175, 0x017f, 0x0189, 0x0192, 0x019c, 0x01a7,
	0x01b1, 0x01bb, 0x01c6, 0x01d1, 0x01dc, 0x01e7, 0x01f2, 0x01fd,
	0x0208, 0x0214, 0x0220, 0x022c, 0x0238, 0x0244, 0x0250, 0x025d,
	0x0269, 0x0276, 0x0283, 0x0290, 0x029d, 0x02aa, 0x02b8, 0x02c6,
	0x02d3, 0x02e1, 0x02ef, 0x02fe, 0x030c, 0x031b, 0x0329, 0x0338,
	0x0347, 0x0356, 0x0366, 0x0375, 0x0385, 0x0394, 0x03a4, 0x03b4,
	0x03c5, 0x03d5, 0x03e6, 0x03f6, 0x0407, 0x0418, 0x0429, 0x043b,
	0x044c, 0x045e, 0x0470, 0x0482, 0x0494, 0x04a6, 0x04b8, 0x04cb,
	0x04de, 0x04f1, 0x0504, 0x0517, 0x052b, 0x053e, 0x0552, 0x0566,
	0x057a, 0x058e, 0x05a2, 0x05b7, 0x05cc, 0x05e1, 0x05f6, 0x060b,
	0x0620, 0x0636, 0x064c, 0x0661, 0x0677, 0x068e, 0x06a4, 0x06bb,
	0x06d1, 0x06e8, 0x06ff, 0x0717, 0x072e, 0x0746, 0x075d, 0x0775,
	0x078d, 0x07a6, 0x07be, 0x07d7, 0x07ef, 0x0808, 0x0821, 0x083b,
	0x0854, 0x086e, 0x0888, 0x08a1, 0x08bc, 0x08d6, 0x08f0, 0x090b,
	0x0926, 0x0941, 0x095c, 0x0978, 0x0993, 0x09af, 0x09cb, 0x09e7,
	0x0a03, 0x0a1f, 0x0a3c, 0x0a59, 0x0a76, 0x0a93, 0x0ab0, 0x0ace,
	0x0aeb, 0x0b09, 0x0b27, 0x0b46, 0x0b64, 0x0b83, 0x0ba1, 0x0bc0,
	0x0bdf, 0x0bff, 0x0c1e, 0x0c3e, 0x0c5e, 0x0c7e, 0x0c9e, 0x0cbe,
	0x0cdf, 0x0d00, 0x0d21, 0x0d42, 0x0d63, 0x0d84, 0x0da6, 0x0dc8,
	0x0dea, 0x0e0c, 0x0e2f, 0x0e51, 0x0e74, 0x0e97, 0x0eba, 0x0ede,
	0x0f01, 0x0f25, 0x0f49, 0x0f6d, 0x0f91, 0x0fb6, 0x0fda, 0x0fff,
	0x0fff
};
static u32 g_gamma_2_4[DEGAMMA_COEF_LEN] = {
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0001,
	0x0001, 0x0001, 0x0002, 0x0002, 0x0003, 0x0003, 0x0004, 0x0005,
	0x0005, 0x0006, 0x0007, 0x0008, 0x0009, 0x000a, 0x000b, 0x000d,
	0x000e, 0x0010, 0x0011, 0x0013, 0x0014, 0x0016, 0x0018, 0x001a,
	0x001c, 0x001e, 0x0021, 0x0023, 0x0025, 0x0028, 0x002a, 0x002d,
	0x0030, 0x0033, 0x0036, 0x0039, 0x003c, 0x0040, 0x0043, 0x0047,
	0x004a, 0x004e, 0x0052, 0x0056, 0x005a, 0x005e, 0x0063, 0x0067,
	0x006c, 0x0070, 0x0075, 0x007a, 0x007f, 0x0084, 0x0089, 0x008f,
	0x0094, 0x009a, 0x00a0, 0x00a6, 0x00ac, 0x00b2, 0x00b8, 0x00be,
	0x00c5, 0x00cb, 0x00d2, 0x00d9, 0x00e0, 0x00e7, 0x00ef, 0x00f6,
	0x00fd, 0x0105, 0x010d, 0x0115, 0x011d, 0x0125, 0x012e, 0x0136,
	0x013f, 0x0147, 0x0150, 0x0159, 0x0163, 0x016c, 0x0175, 0x017f,
	0x0189, 0x0193, 0x019d, 0x01a7, 0x01b1, 0x01bc, 0x01c6, 0x01d1,
	0x01dc, 0x01e7, 0x01f2, 0x01fd, 0x0209, 0x0215, 0x0220, 0x022c,
	0x0238, 0x0245, 0x0251, 0x025e, 0x026a, 0x0277, 0x0284, 0x0291,
	0x029f, 0x02ac, 0x02ba, 0x02c8, 0x02d6, 0x02e4, 0x02f2, 0x0301,
	0x030f, 0x031e, 0x032d, 0x033c, 0x034b, 0x035b, 0x036a, 0x037a,
	0x038a, 0x039a, 0x03aa, 0x03bb, 0x03cb, 0x03dc, 0x03ed, 0x03fe,
	0x040f, 0x0420, 0x0432, 0x0444, 0x0456, 0x0468, 0x047a, 0x048c,
	0x049f, 0x04b2, 0x04c5, 0x04d8, 0x04eb, 0x04ff, 0x0512, 0x0526,
	0x053a, 0x054e, 0x0562, 0x0577, 0x058c, 0x05a1, 0x05b6, 0x05cb,
	0x05e0, 0x05f6, 0x060c, 0x0621, 0x0638, 0x064e, 0x0664, 0x067b,
	0x0692, 0x06a9, 0x06c0, 0x06d7, 0x06ef, 0x0707, 0x071f, 0x0737,
	0x074f, 0x0768, 0x0780, 0x0799, 0x07b2, 0x07cc, 0x07e5, 0x07ff,
	0x0818, 0x0832, 0x084d, 0x0867, 0x0882, 0x089c, 0x08b7, 0x08d2,
	0x08ee, 0x0909, 0x0925, 0x0941, 0x095d, 0x0979, 0x0996, 0x09b2,
	0x09cf, 0x09ec, 0x0a0a, 0x0a27, 0x0a45, 0x0a63, 0x0a81, 0x0a9f,
	0x0abd, 0x0adc, 0x0afb, 0x0b1a, 0x0b39, 0x0b59, 0x0b78, 0x0b98,
	0x0bb8, 0x0bd8, 0x0bf9, 0x0c1a, 0x0c3a, 0x0c5b, 0x0c7d, 0x0c9e,
	0x0cc0, 0x0ce2, 0x0d04, 0x0d26, 0x0d49, 0x0d6b, 0x0d8e, 0x0db1,
	0x0dd4, 0x0df8, 0x0e1c, 0x0e40, 0x0e64, 0x0e88, 0x0ead, 0x0ed1,
	0x0ef6, 0x0f1c, 0x0f41, 0x0f67, 0x0f8c, 0x0fb2, 0x0fd9, 0x0fff,
	0x0fff
};
static u32 g_gamma_2_7[DEGAMMA_COEF_LEN] = {
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0001, 0x0001, 0x0001, 0x0001, 0x0002, 0x0002,
	0x0002, 0x0003, 0x0003, 0x0004, 0x0004, 0x0005, 0x0005, 0x0006,
	0x0007, 0x0008, 0x0009, 0x000a, 0x000b, 0x000c, 0x000d, 0x000e,
	0x000f, 0x0010, 0x0012, 0x0013, 0x0015, 0x0016, 0x0018, 0x001a,
	0x001c, 0x001d, 0x001f, 0x0021, 0x0024, 0x0026, 0x0028, 0x002b,
	0x002d, 0x0030, 0x0032, 0x0035, 0x0038, 0x003b, 0x003e, 0x0041,
	0x0044, 0x0048, 0x004b, 0x004f, 0x0052, 0x0056, 0x005a, 0x005e,
	0x0062, 0x0066, 0x006b, 0x006f, 0x0073, 0x0078, 0x007d, 0x0082,
	0x0087, 0x008c, 0x0091, 0x0096, 0x009c, 0x00a1, 0x00a7, 0x00ad,
	0x00b3, 0x00b9, 0x00bf, 0x00c6, 0x00cc, 0x00d3, 0x00da, 0x00e1,
	0x00e8, 0x00ef, 0x00f6, 0x00fe, 0x0105, 0x010d, 0x0115, 0x011d,
	0x0125, 0x012d, 0x0136, 0x013e, 0x0147, 0x0150, 0x0159, 0x0162,
	0x016c, 0x0175, 0x017f, 0x0189, 0x0193, 0x019d, 0x01a7, 0x01b1,
	0x01bc, 0x01c7, 0x01d2, 0x01dd, 0x01e8, 0x01f4, 0x01ff, 0x020b,
	0x0217, 0x0223, 0x022f, 0x023c, 0x0249, 0x0255, 0x0262, 0x0270,
	0x027d, 0x028a, 0x0298, 0x02a6, 0x02b4, 0x02c2, 0x02d1, 0x02df,
	0x02ee, 0x02fd, 0x030c, 0x031c, 0x032b, 0x033b, 0x034b, 0x035b,
	0x036b, 0x037c, 0x038d, 0x039d, 0x03af, 0x03c0, 0x03d1, 0x03e3,
	0x03f5, 0x0407, 0x0419, 0x042c, 0x043f, 0x0451, 0x0465, 0x0478,
	0x048b, 0x049f, 0x04b3, 0x04c7, 0x04dc, 0x04f0, 0x0505, 0x051a,
	0x052f, 0x0545, 0x055a, 0x0570, 0x0586, 0x059d, 0x05b3, 0x05ca,
	0x05e1, 0x05f8, 0x060f, 0x0627, 0x063f, 0x0657, 0x066f, 0x0688,
	0x06a1, 0x06ba, 0x06d3, 0x06ec, 0x0706, 0x0720, 0x073a, 0x0755,
	0x076f, 0x078a, 0x07a5, 0x07c1, 0x07dc, 0x07f8, 0x0814, 0x0831,
	0x084d, 0x086a, 0x0887, 0x08a4, 0x08c2, 0x08e0, 0x08fe, 0x091c,
	0x093a, 0x0959, 0x0978, 0x0998, 0x09b7, 0x09d7, 0x09f7, 0x0a17,
	0x0a38, 0x0a59, 0x0a7a, 0x0a9b, 0x0abd, 0x0adf, 0x0b01, 0x0b23,
	0x0b46, 0x0b69, 0x0b8c, 0x0baf, 0x0bd3, 0x0bf7, 0x0c1b, 0x0c40,
	0x0c65, 0x0c8a, 0x0caf, 0x0cd5, 0x0cfa, 0x0d21, 0x0d47, 0x0d6e,
	0x0d95, 0x0dbc, 0x0de3, 0x0e0b, 0x0e33, 0x0e5c, 0x0e84, 0x0ead,
	0x0ed7, 0x0f00, 0x0f2a, 0x0f54, 0x0f7e, 0x0fa9, 0x0fd4, 0x0fff,
	0x0fff
};
typedef struct gamma_map {
	uint32_t tag;
	product_type_t product;
	lcd_type_t lcd;
	lcd_panel_info_t lcd_panel_version;
	uint32_t mipi_low;
	uint32_t mipi_high;
	uint32_t* r;
	uint32_t* g;
	uint32_t* b;
} gamma_map_t;
gamma_map_t g_gamma_map[] = {
	{TAG_ALS, PRODUCT_ALT_B, LCD_BOE, DEFAULT_LCD_VER, 0, 4095, g_gamma_1_6, g_gamma_1_6, g_gamma_2_2},
	{TAG_ALS, PRODUCT_ALT_B, LCD_VISIONOX, DEFAULT_LCD_VER, 0, 4095, g_gamma_1_9, g_gamma_1_3, g_gamma_2_4},
	{TAG_ALS1, PRODUCT_ALT_B, LCD_BOE, DEFAULT_LCD_VER, 0, 4095, g_gamma_1_7, g_gamma_1_7, g_gamma_2_2},
	{TAG_ALS1, PRODUCT_ALT_B, LCD_VISIONOX, DEFAULT_LCD_VER, 0, 4095, g_gamma_1_9, g_gamma_1_3, g_gamma_2_2},
	{TAG_ALS, PRODUCT_BARRY, LCD_BOE, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_1, g_gamma_1_9, g_gamma_2_4},
	{TAG_ALS, PRODUCT_BARRY, LCD_VISIONOX, DEFAULT_LCD_VER, 0, 4095, g_gamma_1_9, g_gamma_2_0, g_gamma_2_4},
	{TAG_ALS, PRODUCT_ALLEN, LCD_BOE, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_1, g_gamma_1_8, g_gamma_1_9},
	{TAG_ALS, PRODUCT_ALLEN, LCD_VISIONOX, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_2, g_gamma_2_1, g_gamma_2_2},
	{TAG_ALS, PRODUCT_BLAKE, LCD_VISIONOX, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_0, g_gamma_2_1, g_gamma_2_2},
	{TAG_ALS, PRODUCT_BLAKE, LCD_BOE, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_3, g_gamma_1_8, g_gamma_2_0},
	{TAG_ALS, PRODUCT_BLAKE, LCD_HUAXING, DEFAULT_LCD_VER, 0, 4095, g_gamma_1_8, g_gamma_2_1, g_gamma_2_4},
	{TAG_ALS, PRODUCT_ADELA, LCD_BOE, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_4, g_gamma_2_4, g_gamma_2_4},
	{TAG_ALS, PRODUCT_ADELA, LCD_HUAXING, DEFAULT_LCD_VER, 0, 4095, g_gamma_1_4, g_gamma_2_0, g_gamma_2_2},
	{TAG_ALS, PRODUCT_LEM, LCD_BOE, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_0, g_gamma_1_8, g_gamma_2_2},
	{TAG_ALS, PRODUCT_LEM, LCD_VISIONOX, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_3, g_gamma_2_4, g_gamma_2_2},
	{TAG_ALS, PRODUCT_LEM, LCD_BOE2, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_1, g_gamma_2_0, g_gamma_1_9},
	{TAG_ALS, PRODUCT_ADY, LCD_BOE, DEFAULT_LCD_VER, 800, 4095, g_gamma_2_2, g_gamma_2_2, g_gamma_2_2},
	{TAG_ALS, PRODUCT_ADY, LCD_BOE, DEFAULT_LCD_VER, 0, 800, g_gamma_2_1, g_gamma_1_5_std, g_gamma_2_2},
	{TAG_ALS, PRODUCT_ADY, LCD_BOE2, DEFAULT_LCD_VER, 1500, 4095, g_gamma_1_9, g_gamma_1_6, g_gamma_2_0},
	{TAG_ALS, PRODUCT_ADY, LCD_BOE2, DEFAULT_LCD_VER, 600, 1500, g_gamma_1_8, g_gamma_1_4, g_gamma_2_0},
	{TAG_ALS, PRODUCT_ADY, LCD_BOE2, DEFAULT_LCD_VER, 0, 600, g_gamma_1_7, g_gamma_1_3, g_gamma_2_0},
	{TAG_ALS, PRODUCT_HBN, LCD_BOE, DEFAULT_LCD_VER, 600, 4095, g_gamma_2_4, g_gamma_2_2, g_gamma_2_4},
	{TAG_ALS, PRODUCT_HBN, LCD_BOE, DEFAULT_LCD_VER, 0, 600, g_gamma_2_4, g_gamma_1_5_std, g_gamma_2_4},
	{TAG_ALS, PRODUCT_HBN, LCD_VISIONOX, DEFAULT_LCD_VER, 500, 4095, g_gamma_2_1, g_gamma_2_0, g_gamma_2_2},
	{TAG_ALS, PRODUCT_HBN, LCD_VISIONOX, DEFAULT_LCD_VER, 0, 500, g_gamma_1_8, g_gamma_1_6, g_gamma_2_4},
	{TAG_ALS, PRODUCT_ADL, LCD_BOE, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_4, g_gamma_2_4, g_gamma_2_4},
	{TAG_ALS, PRODUCT_ADL, LCD_HUAXING, DEFAULT_LCD_VER, 0, 4095, g_gamma_1_4, g_gamma_2_0, g_gamma_2_2},
	{TAG_ALS, PRODUCT_GRL, LCD_BOE, DEFAULT_LCD_VER, 0, 1000, g_gamma_2_0, g_gamma_2_0, g_gamma_2_1},
	{TAG_ALS, PRODUCT_GRL, LCD_BOE, DEFAULT_LCD_VER, 1000, 4095, g_gamma_2_3, g_gamma_2_2, g_gamma_2_2},
	{TAG_ALS1, PRODUCT_GRL, LCD_BOE, DEFAULT_LCD_VER, 0, 1000, g_gamma_2_0, g_gamma_2_0, g_gamma_2_1},
	{TAG_ALS1, PRODUCT_GRL, LCD_BOE, DEFAULT_LCD_VER, 1000, 4095, g_gamma_2_3, g_gamma_2_2, g_gamma_2_2},
	{TAG_ALS, PRODUCT_PSD, LCD_BOE2, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_3, g_gamma_2_1, g_gamma_2_2},
	{TAG_ALS, PRODUCT_PSD, LCD_VISIONOX, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_2, g_gamma_2_2, g_gamma_2_2},
	{TAG_ALS, PRODUCT_PSD, LCD_HUAXING, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_0, g_gamma_2_0, g_gamma_2_0},
	{TAG_ALS, PRODUCT_BLS, LCD_VISIONOX, VERSION_2SD, 0, 4095, g_gamma_1_9, g_gamma_1_8, g_gamma_2_2},
	{TAG_ALS, PRODUCT_BLS, LCD_VISIONOX, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_0, g_gamma_2_2, g_gamma_2_3},
	{TAG_ALS, PRODUCT_BLS, LCD_BOE, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_3, g_gamma_1_8, g_gamma_2_0},
	{TAG_ALS, PRODUCT_BLS, LCD_HUAXING, DEFAULT_LCD_VER, 0, 4095, g_gamma_1_8, g_gamma_2_1, g_gamma_2_4},
	{TAG_ALS, PRODUCT_MIS, LCD_BOE, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_4, g_gamma_2_0, g_gamma_2_4},
	{TAG_ALS, PRODUCT_MIS, LCD_HUAXING, DEFAULT_LCD_VER, 0, 4095, g_gamma_2_2, g_gamma_2_2, g_gamma_2_3},
};
typedef struct gamma_nvdata_map {
	uint32_t nvdata;
	uint32_t* r;
	uint32_t* g;
	uint32_t* b;
} gamma_nvdata_map_t;
gamma_nvdata_map_t g_gamma_nvdata_map[] = {
	{GAMMA_TYPE_O_BOE, g_gamma_1_6, g_gamma_1_5_std, g_gamma_2_2},
	{GAMMA_TYPE_N_SM, g_gamma_2_0, g_gamma_2_0, g_gamma_2_2},
	{GAMMA_TYPE_N_LG, g_gamma_1_5, g_gamma_1_7, g_gamma_2_2},
	{GAMMA_TYPE_NP_SM, g_gamma_2_0, g_gamma_2_0, g_gamma_2_2},
	{GAMMA_TYPE_NP_LG, g_gamma_1_5, g_gamma_1_7, g_gamma_2_2},
	{GAMMA_TYPE_J_BOE, g_gamma_1_6, g_gamma_1_7, g_gamma_2_2},
	{GAMMA_TYPE_J_LG, g_gamma_1_6, g_gamma_2_2, g_gamma_2_2}
};
static uint32_t calculate_alpha_from_gamma(uint32_t* gamma, uint32_t alpha,
	uint32_t index, uint32_t pos)
{
	int32_t step = (int32_t)gamma[index + 1] - (int32_t)gamma[index];
	int32_t range = ((index + 1) == (DEGAMMA_COEF_LEN - 1)) ?
		(ALS_ALPHA_RANGE_PER_STEP - 1) : ALS_ALPHA_RANGE_PER_STEP;
	uint32_t ret;

	/* 2: half range */
	ret = (uint32_t)(gamma[index] + ((step * pos) + (range / 2)) / range);
	return (ret > ALS_ALPHA_VAL_MAX) ? ALS_ALPHA_VAL_MAX : ret;
}

static void gamma_choice_with_alpha(struct als_gamma_config *cfg)
{
	uint32_t i;
	uint32_t alpha;
	uint32_t alpha_r;
	uint32_t alpha_g;
	uint32_t alpha_b;
	uint32_t pos;

	alpha = cfg->alpha_gamma;
	if (alpha > ALS_ALPHA_VAL_MAX) {
		hwlog_info("%s error, alpha=%u\n", __func__, alpha);
		return;
	}

	i = alpha / ALS_ALPHA_RANGE_PER_STEP;
	if ((i + 1) > (DEGAMMA_COEF_LEN - 1)) {
		hwlog_info("%s error\n", __func__);
		return;
	}
	pos = alpha % ALS_ALPHA_RANGE_PER_STEP;
	alpha_r = calculate_alpha_from_gamma(cfg->r_gamma, alpha, i, pos);
	alpha_g = calculate_alpha_from_gamma(cfg->g_gamma, alpha, i, pos);
	alpha_b = calculate_alpha_from_gamma(cfg->b_gamma, alpha, i, pos);

	hwlog_info("%s i=%u pos=%u alpha=%u alpha_r=%u alpha_g=%u alpha_b=%u\n",
		__func__, i, pos, alpha, alpha_r, alpha_g, alpha_b);

	for (i = 0; i < DEGAMMA_COEF_LEN; i++) {
#ifdef DSS_ALSC_NOISE
		hisi_dss_alsc_init.degamma_lut_r[i] =
			(cfg->r_gamma[i] * alpha_r + ALS_ALPHA_HALF_MAX) /
			ALS_ALPHA_VAL_MAX;
		hisi_dss_alsc_init.degamma_lut_g[i] =
			(cfg->g_gamma[i] * alpha_g + ALS_ALPHA_HALF_MAX) /
			ALS_ALPHA_VAL_MAX;
		hisi_dss_alsc_init.degamma_lut_b[i] =
			(cfg->b_gamma[i] * alpha_b + ALS_ALPHA_HALF_MAX) /
			ALS_ALPHA_VAL_MAX;
#elif defined DKMD_ALSC_NOISE
		hisi_dss_alsc_init.degamma_coef.r_coef[i] =
			(cfg->r_gamma[i] * alpha_r + ALS_ALPHA_HALF_MAX) /
			ALS_ALPHA_VAL_MAX;
		hisi_dss_alsc_init.degamma_coef.g_coef[i] =
			(cfg->g_gamma[i] * alpha_g + ALS_ALPHA_HALF_MAX) /
			ALS_ALPHA_VAL_MAX;
		hisi_dss_alsc_init.degamma_coef.b_coef[i] =
			(cfg->b_gamma[i] * alpha_b + ALS_ALPHA_HALF_MAX) /
			ALS_ALPHA_VAL_MAX;
#endif
	}
}

static bool gamma_choice(u32 *r_gamma, u32 *g_gamma, u32 *b_gamma)
{
	int i;

	if (!r_gamma || !g_gamma || !b_gamma) {
		hwlog_err("%s para error\n", __func__);
		return false;
	}

	for (i = 0; i < DEGAMMA_COEF_LEN; i++) {
#ifdef DSS_ALSC_NOISE
		hisi_dss_alsc_init.degamma_lut_r[i] = r_gamma[i];
		hisi_dss_alsc_init.degamma_lut_g[i] = g_gamma[i];
		hisi_dss_alsc_init.degamma_lut_b[i] = b_gamma[i];
#elif defined DKMD_ALSC_NOISE
		hisi_dss_alsc_init.degamma_coef.r_coef[i] = r_gamma[i];
		hisi_dss_alsc_init.degamma_coef.g_coef[i] = g_gamma[i];
		hisi_dss_alsc_init.degamma_coef.b_coef[i] = b_gamma[i];
#endif
	}
	if (g_als_gamma_cfg.r_gamma == r_gamma && g_als_gamma_cfg.g_gamma == g_gamma &&
		g_als_gamma_cfg.b_gamma == b_gamma)
		return false;
	g_als_gamma_cfg.r_gamma = r_gamma;
	g_als_gamma_cfg.g_gamma = g_gamma;
	g_als_gamma_cfg.b_gamma = b_gamma;
	g_als_gamma_cfg.alpha_gamma = ALS_ALPHA_VAL_MAX;
	g_als_gamma_cfg.is_init = 1;
	return true;
}

static void gamma_by_nvdata(uint32_t nvdata, u32** r_gamma, u32** g_gamma, u32** b_gamma)
{
	int i;
	for (i = 0; i < ARRAY_SIZE(g_gamma_nvdata_map); i++) {
		if (nvdata == g_gamma_nvdata_map[i].nvdata) {
			*r_gamma = g_gamma_nvdata_map[i].r;
			*g_gamma = g_gamma_nvdata_map[i].g;
			*b_gamma = g_gamma_nvdata_map[i].b;
			hwlog_info("%s: g_gamma_nvdata_map %d found %p %p %p success\n", __func__, i, *r_gamma, *g_gamma, *b_gamma);
			return;
		}
	}
	hwlog_info("%s: g_gamma_nvdata_map found fail\n", __func__);
}

static void gamma_by_product(u32 tag, uint32_t mipi, u32** r_gamma, u32** g_gamma, u32** b_gamma)
{
	int i;
	int8_t panel_version = DEFAULT_LCD_VER;
#ifdef ALS_PANEL_VERSION
	panel_version = get_panel_version(tag);
#endif

	for (i = 0; i < ARRAY_SIZE(g_gamma_map); i++) {
		if (tag == g_gamma_map[i].tag && g_product_type == g_gamma_map[i].product && g_lcd_type == g_gamma_map[i].lcd
			&& (panel_version == DEFAULT_LCD_VER || panel_version == g_gamma_map[i].lcd_panel_version)
			&& mipi >= g_gamma_map[i].mipi_low && mipi < g_gamma_map[i].mipi_high) {
			*r_gamma = g_gamma_map[i].r;
			*g_gamma = g_gamma_map[i].g;
			*b_gamma = g_gamma_map[i].b;
			hwlog_info("%s: g_gamma_map %d found %p %p %p success\n", __func__, i, *r_gamma, *g_gamma, *b_gamma);
			return;
		}
	}
	hwlog_info("%s: g_gamma_map found fail\n", __func__);
}

bool als_gamma_param_config(uint32_t tag, uint32_t mipi)
{
	uint32_t nv_data;
	uint32_t nv_version = 0;
	struct als_device_info *dev_info = NULL;
	u32 *r_gamma = NULL;
	u32 *g_gamma = NULL;
	u32 *b_gamma = NULL;
	int8_t ddic = UNKNOWN_DDIC;
	bool need_update = false;

	dev_info = als_get_device_info(tag);
	if (dev_info == NULL)
		return false;

	if(dev_info->als_ud_nv_type == 1) {
		/* res[2] save nv */
		nv_data = (uint32_t)(dev_info->als_under_tp_cal_data.nv_type_gamma.res[2]);
	} else {
		/* 29 save nv */
		nv_version = (uint32_t)(dev_info->als_under_tp_cal_data.nv_type_defult.b[28]);
		nv_data = (uint32_t)(dev_info->als_under_tp_cal_data.nv_type_defult.b[29]);
	}

	hwlog_info("%s nv_data=%u", __func__, nv_data);
	g_product_type = (nv_data & 0xff000) >> 12;
	g_lcd_type = (nv_data & 0x0f00) >> 8;
	g_sensor_type = nv_version >= EDITION_SENSORFLAG_SHIFT ? (nv_data & 0x00ff) : (nv_data & 0x00f0) >> 4;
	nv_data = ((nv_data & 0x0000ffff) >> 8);
	ddic = get_ddic(tag);
	if (ddic == DDIC_HISI)
		mipi = mipi / COEF_MIPI_HXX_CXX;
	hwlog_info("%s gamma type: %d, product %d, lcd %d, sensor %d, ddic %d", __func__,
		nv_data, g_product_type, g_lcd_type, g_sensor_type, ddic);

	if ((nv_data == GAMMA_TYPE_N_BOE) || (nv_data == GAMMA_TYPE_NP_BOE)) {
		if(dev_info->chip_type == ALS_CHIP_AMS_TSL2540_RGB) {
			hwlog_info("%s chip info G-IR", __func__);
			r_gamma = g_gamma_2_0;
			g_gamma = g_gamma_1_6;
			b_gamma = g_gamma_2_2;
		} else {
			r_gamma = g_gamma_1_6;
			g_gamma = g_gamma_1_5_std;
			b_gamma = g_gamma_2_2;
		}
	} else {
		hwlog_info("%s gamma type default", __func__);
		r_gamma = g_gamma_1_7;
		g_gamma = g_gamma_1_7;
		b_gamma = g_gamma_2_2;
	}
	gamma_by_nvdata(nv_data, &r_gamma, &g_gamma, &b_gamma);
	gamma_by_product(tag, mipi, &r_gamma, &g_gamma, &b_gamma);
	need_update = gamma_choice(r_gamma, g_gamma, b_gamma);
	return need_update;
}

#ifdef DSS_ALSC_NOISE
void als_gamma_set_alpha(uint32_t alpha)
{
	if (g_als_gamma_cfg.alpha_is_set == 1 &&
		g_als_gamma_cfg.alpha_val == alpha)
		return;

	g_als_gamma_cfg.alpha_val = (alpha > ALS_ALPHA_VAL_MAX) ?
		ALS_ALPHA_VAL_MAX : alpha;
	g_als_gamma_cfg.alpha_is_set = 1;
	hwlog_info("%s alpha=%u\n", __func__, alpha);
}
#elif defined DKMD_ALSC_NOISE
void als_gamma_set_alpha(uint32_t alpha, uint32_t panel_id)
{
	if (g_als_gamma_cfg.alpha_is_set == 1 &&
		g_als_gamma_cfg.alpha_val == alpha)
		return;

	g_als_gamma_cfg.alpha_val = (alpha > ALS_ALPHA_VAL_MAX) ?
		ALS_ALPHA_VAL_MAX : alpha;
	g_als_gamma_cfg.alpha_is_set = 1;
	hwlog_info("%s alpha=%u\n", __func__, alpha);
}
#endif

int als_gamma_update_with_alpha(void)
{
	if (g_als_gamma_cfg.is_init == 0) {
		hwlog_info("%s not init\n", __func__);
		return -1;
	}

	if (g_als_gamma_cfg.alpha_is_set == 0 ||
		g_als_gamma_cfg.alpha_val == g_als_gamma_cfg.alpha_gamma)
		return -1;

	g_als_gamma_cfg.alpha_gamma = g_als_gamma_cfg.alpha_val;
	gamma_choice_with_alpha(&g_als_gamma_cfg);
	return 0;
}
#endif

